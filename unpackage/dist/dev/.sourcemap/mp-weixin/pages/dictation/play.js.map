{"version":3,"file":"play.js","sources":["pages/dictation/play.vue","pages/dictation/play.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"play-container\">\n    <view class=\"top-info\">\n      <text class=\"timer\">Áî®Êó∂Ôºö{{ elapsedDisplay }}</text>\n      <text class=\"progress\">{{ currentIndex + 1 }}/{{ total }}</text>\n    </view>\n\n    <view class=\"speak-box\">\n      <button size=\"mini\" @click=\"playAudio\">üîä Êí≠Êîæ</button>\n    </view>\n\n    <view class=\"input-box\">\n      <input\n        class=\"answer-input\"\n        v-model=\"answer\"\n        placeholder=\"ËØ∑ËæìÂÖ•‰Ω†Âê¨Âà∞ÁöÑÂçïËØç\"\n        confirm-type=\"done\"\n      />\n    </view>\n\n    <view class=\"progress-bar\">\n      <view\n        class=\"progress-fill\"\n        :style=\"{ width: progressPercent + '%' }\"\n      ></view>\n    </view>\n\n    <view class=\"result\" v-if=\"showResult\">\n      <text :class=\"{ ok: lastCorrect, wrong: !lastCorrect }\">\n        {{ lastCorrect ? \"Ê≠£Á°ÆÔºÅ\" : \"ÈîôËØØÔºåÊ≠£Á°ÆÁ≠îÊ°àÔºö\" + currentWord }}\n      </text>\n    </view>\n\n    <view class=\"bottom\">\n      <button type=\"primary\" @click=\"submit\">Êèê‰∫§</button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      words: [],\n      currentIndex: 0,\n      answer: \"\",\n      showResult: false,\n      lastCorrect: false,\n      startTs: 0,\n      timerId: null,\n      elapsedMs: 0,\n    };\n  },\n  computed: {\n    total() {\n      return this.words.length;\n    },\n    currentWord() {\n      return this.words[this.currentIndex] || \"\";\n    },\n    progressPercent() {\n      return this.total\n        ? Math.floor((this.currentIndex / this.total) * 100)\n        : 0;\n    },\n    elapsedDisplay() {\n      const s = Math.floor(this.elapsedMs / 1000);\n      const mm = String(Math.floor(s / 60)).padStart(2, \"0\");\n      const ss = String(s % 60).padStart(2, \"0\");\n      return `${mm}:${ss}`;\n    },\n  },\n  onLoad() {\n    const list = uni.getStorageSync(\"DICTATION_WORDS\") || [];\n    this.words =\n      Array.isArray(list) && list.length ? list : [\"apple\", \"banana\", \"orange\"];\n    this.startTimer();\n  },\n  onUnload() {\n    this.stopTimer();\n  },\n  methods: {\n    startTimer() {\n      this.startTs = Date.now();\n      this.timerId = setInterval(() => {\n        this.elapsedMs = Date.now() - this.startTs;\n      }, 250);\n    },\n    stopTimer() {\n      if (this.timerId) {\n        clearInterval(this.timerId);\n        this.timerId = null;\n      }\n    },\n    playAudio() {\n      // ÁÆÄÂåñÂ§ÑÁêÜÔºöH5 ‰ΩøÁî®ÊµèËßàÂô®ËØ≠Èü≥ÂêàÊàêÔºåÂÖ∂‰ªñÂπ≥Âè∞Áî® Toast Ê®°Êãü\n      // #ifdef H5\n      try {\n        const utter = new SpeechSynthesisUtterance(this.currentWord);\n        utter.lang = \"en-US\";\n        window.speechSynthesis.cancel();\n        window.speechSynthesis.speak(utter);\n      } catch (e) {\n        uni.showToast({ title: \"Êó†Ê≥ïÊí≠ÊîæËØ≠Èü≥\", icon: \"none\" });\n      }\n      // #endif\n      // #ifndef H5\n      uni.showToast({ title: `Êí≠ÊîæÔºö${this.currentWord}`, icon: \"none\" });\n      // #endif\n    },\n    submit() {\n      if (!this.currentWord) return;\n      const normalizedAnswer = String(this.answer || \"\")\n        .trim()\n        .toLowerCase();\n      const normalizedTarget = String(this.currentWord).trim().toLowerCase();\n      const correct = normalizedAnswer === normalizedTarget;\n      this.lastCorrect = correct;\n      this.showResult = true;\n\n      if (correct) {\n        // Áü≠ÊöÇÂ±ïÁ§∫ÂêéËøõÂÖ•‰∏ã‰∏ÄÈ¢ò\n        setTimeout(() => {\n          this.answer = \"\";\n          this.showResult = false;\n          if (this.currentIndex < this.total - 1) {\n            this.currentIndex += 1;\n          } else {\n            this.finish();\n          }\n        }, 400);\n      }\n    },\n    finish() {\n      this.stopTimer();\n      uni.showModal({\n        title: \"ÂÆåÊàê\",\n        content: `ÂÖ± ${this.total} ‰∏™ÂçïËØçÔºåÁî®Êó∂ ${this.elapsedDisplay}`,\n        showCancel: false,\n        success: () => {\n          uni.navigateBack();\n        },\n      });\n    },\n  },\n};\n</script>\n\n<style>\n.play-container {\n  padding: 30rpx;\n  min-height: 100vh;\n  background: #f7f7f7;\n}\n.top-info {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 30rpx;\n  color: #666;\n}\n.speak-box {\n  display: flex;\n  justify-content: center;\n  margin: 30rpx 0;\n}\n.input-box {\n  margin: 20rpx 0 40rpx;\n}\n.answer-input {\n  background: #fff;\n  border-radius: 12rpx;\n  padding: 20rpx;\n  font-size: 30rpx;\n}\n.progress-bar {\n  height: 16rpx;\n  background: #eee;\n  border-radius: 8rpx;\n  overflow: hidden;\n}\n.progress-fill {\n  height: 100%;\n  background: #007aff;\n  width: 0;\n  transition: width 0.25s ease;\n}\n.result {\n  margin: 24rpx 0;\n  text-align: center;\n}\n.result .ok {\n  color: #07c160;\n}\n.result .wrong {\n  color: #fa5151;\n}\n.bottom {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  padding: 20rpx;\n  background: #fff;\n  box-shadow: 0 -6rpx 20rpx rgba(0, 0, 0, 0.06);\n}\n</style>\n","import MiniProgramPage from '/Users/wangpiper/Documents/HBuilderProjects/uni-demo/pages/dictation/play.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAwCA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,OAAO,CAAE;AAAA,MACT,cAAc;AAAA,MACd,QAAQ;AAAA,MACR,YAAY;AAAA,MACZ,aAAa;AAAA,MACb,SAAS;AAAA,MACT,SAAS;AAAA,MACT,WAAW;AAAA;EAEd;AAAA,EACD,UAAU;AAAA,IACR,QAAQ;AACN,aAAO,KAAK,MAAM;AAAA,IACnB;AAAA,IACD,cAAc;AACZ,aAAO,KAAK,MAAM,KAAK,YAAY,KAAK;AAAA,IACzC;AAAA,IACD,kBAAkB;AAChB,aAAO,KAAK,QACR,KAAK,MAAO,KAAK,eAAe,KAAK,QAAS,GAAG,IACjD;AAAA,IACL;AAAA,IACD,iBAAiB;AACf,YAAM,IAAI,KAAK,MAAM,KAAK,YAAY,GAAI;AAC1C,YAAM,KAAK,OAAO,KAAK,MAAM,IAAI,EAAE,CAAC,EAAE,SAAS,GAAG,GAAG;AACrD,YAAM,KAAK,OAAO,IAAI,EAAE,EAAE,SAAS,GAAG,GAAG;AACzC,aAAO,GAAG,EAAE,IAAI,EAAE;AAAA,IACnB;AAAA,EACF;AAAA,EACD,SAAS;AACP,UAAM,OAAOA,cAAG,MAAC,eAAe,iBAAiB,KAAK,CAAA;AACtD,SAAK,QACH,MAAM,QAAQ,IAAI,KAAK,KAAK,SAAS,OAAO,CAAC,SAAS,UAAU,QAAQ;AAC1E,SAAK,WAAU;AAAA,EAChB;AAAA,EACD,WAAW;AACT,SAAK,UAAS;AAAA,EACf;AAAA,EACD,SAAS;AAAA,IACP,aAAa;AACX,WAAK,UAAU,KAAK;AACpB,WAAK,UAAU,YAAY,MAAM;AAC/B,aAAK,YAAY,KAAK,IAAG,IAAK,KAAK;AAAA,MACpC,GAAE,GAAG;AAAA,IACP;AAAA,IACD,YAAY;AACV,UAAI,KAAK,SAAS;AAChB,sBAAc,KAAK,OAAO;AAC1B,aAAK,UAAU;AAAA,MACjB;AAAA,IACD;AAAA,IACD,YAAY;AAaVA,oBAAAA,MAAI,UAAU,EAAE,OAAO,MAAM,KAAK,WAAW,IAAI,MAAM,OAAQ,CAAA;AAAA,IAEhE;AAAA,IACD,SAAS;AACP,UAAI,CAAC,KAAK;AAAa;AACvB,YAAM,mBAAmB,OAAO,KAAK,UAAU,EAAE,EAC9C,KAAK,EACL;AACH,YAAM,mBAAmB,OAAO,KAAK,WAAW,EAAE,KAAI,EAAG;AACzD,YAAM,UAAU,qBAAqB;AACrC,WAAK,cAAc;AACnB,WAAK,aAAa;AAElB,UAAI,SAAS;AAEX,mBAAW,MAAM;AACf,eAAK,SAAS;AACd,eAAK,aAAa;AAClB,cAAI,KAAK,eAAe,KAAK,QAAQ,GAAG;AACtC,iBAAK,gBAAgB;AAAA,iBAChB;AACL,iBAAK,OAAM;AAAA,UACb;AAAA,QACD,GAAE,GAAG;AAAA,MACR;AAAA,IACD;AAAA,IACD,SAAS;AACP,WAAK,UAAS;AACdA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,KAAK,KAAK,KAAK,WAAW,KAAK,cAAc;AAAA,QACtD,YAAY;AAAA,QACZ,SAAS,MAAM;AACbA,wBAAG,MAAC,aAAY;AAAA,QACjB;AAAA,MACH,CAAC;AAAA,IACF;AAAA,EACF;AACH;;;;;;;;;;;;;;;;;;;;AChJA,GAAG,WAAW,eAAe;"}