{"version":3,"file":"units.js","sources":["pages/dictation/units.vue","pages/dictation/units.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"units-container\">\n    <view class=\"header\">\n      <text class=\"title\">选择单元单词</text>\n    </view>\n\n    <view class=\"units-list\">\n      <view class=\"unit-card\" v-for=\"unit in units\" :key=\"unit.id\">\n        <view class=\"unit-header\">\n          <text class=\"unit-name\">{{ unit.name }}</text>\n          <view class=\"unit-actions\">\n            <button size=\"mini\" @click=\"toggleSelectUnit(unit)\">\n              {{ isUnitAllSelected(unit) ? \"取消全选\" : \"全选本单元\" }}\n            </button>\n          </view>\n        </view>\n\n        <checkbox-group @change=\"onCheckboxChange(unit, $event)\">\n          <view class=\"word-item\" v-for=\"w in unit.words\" :key=\"w\">\n            <label class=\"word-label\">\n              <checkbox :value=\"w\" :checked=\"isChecked(unit, w)\" />\n              <text class=\"word-text\">{{ w }}</text>\n            </label>\n          </view>\n        </checkbox-group>\n      </view>\n    </view>\n\n    <view class=\"bottom-bar\">\n      <text class=\"selected-count\">已选 {{ totalSelected }} 个单词</text>\n      <button\n        type=\"primary\"\n        :disabled=\"totalSelected === 0\"\n        @click=\"startDictation\"\n      >\n        开始听写\n      </button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      units: [\n        {\n          id: \"u1\",\n          name: \"Unit 1\",\n          words: [\"apple\", \"banana\", \"orange\", \"grape\"],\n        },\n        {\n          id: \"u2\",\n          name: \"Unit 2\",\n          words: [\"table\", \"chair\", \"window\", \"door\"],\n        },\n        { id: \"u3\", name: \"Unit 3\", words: [\"red\", \"blue\", \"green\", \"yellow\"] },\n      ],\n      selectedMap: {},\n    };\n  },\n  computed: {\n    totalSelected() {\n      return Object.values(this.selectedMap).reduce(\n        (sum, arr) => sum + arr.length,\n        0\n      );\n    },\n  },\n  methods: {\n    ensureUnitKey(unitId) {\n      if (!this.selectedMap[unitId]) this.$set(this.selectedMap, unitId, []);\n    },\n    isChecked(unit, word) {\n      const list = this.selectedMap[unit.id] || [];\n      return list.includes(word);\n    },\n    isUnitAllSelected(unit) {\n      const list = this.selectedMap[unit.id] || [];\n      return list.length === unit.words.length;\n    },\n    toggleSelectUnit(unit) {\n      this.ensureUnitKey(unit.id);\n      if (this.isUnitAllSelected(unit)) {\n        this.selectedMap[unit.id] = [];\n      } else {\n        this.selectedMap[unit.id] = [...unit.words];\n      }\n      this.selectedMap = { ...this.selectedMap };\n    },\n    onCheckboxChange(unit, e) {\n      // e.detail.value 为选中的值数组\n      this.selectedMap[unit.id] = e.detail.value;\n      this.selectedMap = { ...this.selectedMap };\n    },\n    startDictation() {\n      const words = Object.entries(this.selectedMap).flatMap(\n        ([unitId, arr]) => arr\n      );\n      if (!words.length) {\n        uni.showToast({ title: \"请先选择单词\", icon: \"none\" });\n        return;\n      }\n      // 使用 storage 传递数据，避免 query 过长\n      uni.setStorageSync(\"DICTATION_WORDS\", words);\n      uni.navigateTo({ url: \"/pages/dictation/play\" });\n    },\n  },\n};\n</script>\n\n<style>\n.units-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding-bottom: 140rpx;\n}\n.header {\n  padding: 30rpx 30rpx 0 30rpx;\n}\n.title {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: #333;\n}\n.units-list {\n  padding: 20rpx 20rpx 140rpx 20rpx;\n}\n.unit-card {\n  background: #ffffff;\n  border-radius: 16rpx;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n}\n.unit-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10rpx;\n}\n.unit-name {\n  font-size: 30rpx;\n  color: #333;\n}\n.word-item {\n  padding: 14rpx 0;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n.word-item:last-child {\n  border-bottom: none;\n}\n.word-label {\n  display: flex;\n  align-items: center;\n}\n.word-text {\n  margin-left: 16rpx;\n  font-size: 28rpx;\n  color: #333;\n}\n.bottom-bar {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 20rpx 24rpx;\n  box-shadow: 0 -6rpx 20rpx rgba(0, 0, 0, 0.06);\n}\n.selected-count {\n  color: #666;\n  font-size: 26rpx;\n}\n</style>\n","import MiniProgramPage from '/Users/wangpiper/Documents/HBuilderProjects/uni-demo/pages/dictation/units.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AA0CA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,OAAO;AAAA,QACL;AAAA,UACE,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO,CAAC,SAAS,UAAU,UAAU,OAAO;AAAA,QAC7C;AAAA,QACD;AAAA,UACE,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO,CAAC,SAAS,SAAS,UAAU,MAAM;AAAA,QAC3C;AAAA,QACD,EAAE,IAAI,MAAM,MAAM,UAAU,OAAO,CAAC,OAAO,QAAQ,SAAS,QAAQ,EAAG;AAAA,MACxE;AAAA,MACD,aAAa,CAAE;AAAA;EAElB;AAAA,EACD,UAAU;AAAA,IACR,gBAAgB;AACd,aAAO,OAAO,OAAO,KAAK,WAAW,EAAE;AAAA,QACrC,CAAC,KAAK,QAAQ,MAAM,IAAI;AAAA,QACxB;AAAA;IAEH;AAAA,EACF;AAAA,EACD,SAAS;AAAA,IACP,cAAc,QAAQ;AACpB,UAAI,CAAC,KAAK,YAAY,MAAM;AAAG,aAAK,KAAK,KAAK,aAAa,QAAQ,CAAE,CAAA;AAAA,IACtE;AAAA,IACD,UAAU,MAAM,MAAM;AACpB,YAAM,OAAO,KAAK,YAAY,KAAK,EAAE,KAAK;AAC1C,aAAO,KAAK,SAAS,IAAI;AAAA,IAC1B;AAAA,IACD,kBAAkB,MAAM;AACtB,YAAM,OAAO,KAAK,YAAY,KAAK,EAAE,KAAK;AAC1C,aAAO,KAAK,WAAW,KAAK,MAAM;AAAA,IACnC;AAAA,IACD,iBAAiB,MAAM;AACrB,WAAK,cAAc,KAAK,EAAE;AAC1B,UAAI,KAAK,kBAAkB,IAAI,GAAG;AAChC,aAAK,YAAY,KAAK,EAAE,IAAI,CAAA;AAAA,aACvB;AACL,aAAK,YAAY,KAAK,EAAE,IAAI,CAAC,GAAG,KAAK,KAAK;AAAA,MAC5C;AACA,WAAK,cAAc,EAAE,GAAG,KAAK;IAC9B;AAAA,IACD,iBAAiB,MAAM,GAAG;AAExB,WAAK,YAAY,KAAK,EAAE,IAAI,EAAE,OAAO;AACrC,WAAK,cAAc,EAAE,GAAG,KAAK;IAC9B;AAAA,IACD,iBAAiB;AACf,YAAM,QAAQ,OAAO,QAAQ,KAAK,WAAW,EAAE;AAAA,QAC7C,CAAC,CAAC,QAAQ,GAAG,MAAM;AAAA;AAErB,UAAI,CAAC,MAAM,QAAQ;AACjBA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,OAAK,CAAG;AAC/C;AAAA,MACF;AAEAA,oBAAAA,MAAI,eAAe,mBAAmB,KAAK;AAC3CA,oBAAAA,MAAI,WAAW,EAAE,KAAK,wBAAyB,CAAA;AAAA,IAChD;AAAA,EACF;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;AC3GA,GAAG,WAAW,eAAe;"}